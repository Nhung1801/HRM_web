<div class="toast-container">
    <p-messages [enableService]="false" [closable]="false"></p-messages>
</div>
<div class="grid">
    <div class="col-12">
        <p-toolbar styleClass="mb-2">
            <div>
                <strong class="font-size-16">Đối tượng</strong>
                <p-breadcrumb></p-breadcrumb>
            </div>
            <div
                class="btn-add-wrapper"
                *ngIf="
                    this.permisionHelper.hasPermissions([
                        permissionConstant.ManageObjectCreate
                    ])
                "
            >
                <button
                    pButton
                    pRipple
                    label="+Thêm mới"
                    style="height: 40px; width: 130px; border-radius: 10px"
                    [routerLink]="['/object/create']"
                ></button>
            </div>
        </p-toolbar>
        <div class="card">
            <div class="d-flex">
                <!-- <span
                    class="item-object"
                    (click)="onClickObject1()"
                    [ngClass]="{ active: !isShowObject1 }"
                >
                    Người dùng
                </span> -->
                <span
                    class="item-object"
                    (click)="onClickObject2()"
                    [ngClass]="{ active: !isShowObject2 }"
                >
                    Nhân viên
                </span>
            </div>
        </div>
        <!--  danh sách người dùng -->

        <!--  danh sách nhân viên -->

        <!-- popup thông tin chi tiết chung và nhân viên -->
        <!-- <p-dialog header="Thông tin chi tiết" [(visible)]="isDialogVisible" [modal]="true" [style]="{ width: '60vw' }"
            [closable]="true">
            <div class="dialog-container">
                <div class="header-section">
                    <img [src]="baseImageUrl + selectedObject?.avatarUrl" style="border-radius: 50%" width="100px"
                        height="100px" class="me-2" />

                    <div class="user-details">
                        <h3>
                            {{ selectedObject?.firstName }}
                            {{ selectedObject?.lastName }}
                            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512"
                                height="20px" width="20px" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z">
                                </path>
                            </svg>
                        </h3>
                        <p>
                            {{ selectedObject?.firstName }}
                            {{ selectedObject?.lastName }} •
                            {{ selectedObject?.accountEmail }}
                        </p>
                        <div class="status">
                            <span class="status-badge working" style="background-color: #2a2986; color: #fff"><span
                                    style="color: #fff">Nhân viên</span> •
                                -------------</span>
                            <span class="status-badge active" style="background-color: #2a2986; color: #fff"><span
                                    style="color: #fff">Tài khoản</span> •
                                ...........</span>
                        </div>
                    </div>
                </div>

                <div class="tab-section">
                    <ul class="tab-menu">
                        <li [class.active]="activeTab === 'general'" (click)="setActiveTab('general')">
                            Thông tin chung
                        </li>
                        <li [class.active]="activeTab === 'employee'" (click)="setActiveTab('employee')">
                            Thông tin nhân viên
                        </li>
                    </ul>
                </div>

                <div class="tab-content">
                    <div *ngIf="activeTab === 'general'" class="user-info">
                        <div class="info-item">
                            <strong>Họ và tên:</strong>
                            <span>{{ selectedObject?.firstName }}
                                {{ selectedObject?.lastName }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Số điện thoại:</strong>
                            <span>{{ selectedObject?.phoneNumber }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Email liên hệ:</strong>
                            <a style="text-decoration: underline">{{
                                selectedObject?.accountEmail
                                }}</a>
                        </div>
                        <div class="info-item">
                            <strong>Email tài khoản:</strong>
                            <a style="
                                    text-decoration: underline;
                                    color: rgb(0, 174, 255);
                                ">{{ selectedObject?.accountEmail }}</a>
                        </div>
                        <div class="info-item">
                            <strong>Ngày sinh:</strong>
                            <span>{{
                                selectedObject?.dateOfBirth
                                | date : "dd-MM-yyyy"
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Địa chỉ:</strong>
                            <span>{{ selectedObject?.address }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Giới tính:</strong>
                            <span>{{
                                selectedObject?.sex == 0
                                ? "Nữ"
                                : selectedObject?.sex == 1
                                ? "Nam"
                                : "Khác"
                                }}</span>
                        </div>
                    </div>

                    <div *ngIf="activeTab === 'employee'" class="user-info">
                        <div class="info-item">
                            <strong>Mã nhân viên:</strong>
                            <span>{{ selectedObject.employeeCode }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Email công ty:</strong>
                            <span>{{ selectedObject.companyEmail }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Đơn vị công tác:</strong>
                            <span>{{
                                selectedObject.organizationLeaders[0]
                                ?.organizationName
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Tên vị trí công việc:</strong>
                            <span>{{
                                selectedObject.staffPosition.positionName
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Chức danh:</strong>
                            <span>{{
                                selectedObject.staffTitle.staffTitleName
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Quản lý trực tiếp:</strong>
                            <span *ngIf="selectedObject.managerDirect != null">{{ selectedObject.managerDirect?.lastName
                                }}
                                {{ selectedObject.managerDirect?.firstName }}</span>
                            <span *ngIf="selectedObject.managerDirect == null">Không có</span>
                        </div>
                        <div class="info-item">
                            <strong>Ngày thử việc:</strong>
                            <span>{{
                                selectedObject.probationDate
                                | date : "dd-MM-yyyy"
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Ngày chính thức:</strong>
                            <span>{{
                                selectedObject.officialDate
                                | date : "dd-MM-yyyy"
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Trạng thái lao động:</strong>
                            <span>{{
                                selectedObject.workingStatus == 0
                                ? "Đang làm việc"
                                : "Đã nghỉ việc"
                                }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Ngày nghỉ việc:</strong>
                            <span>{{
                                selectedObject.leaveJobDate
                                | date : "dd-MM-yyyy"
                                }}</span>
                        </div>
                    </div>
                </div>

                <div class="dialog-footer">
                    <button *ngIf="activeTab === 'general'" pButton type="button" label="Gửi email kích hoạt"
                        class="p-button-danger" style="color: #fff !important"></button>

                    <ng-container *ngIf="activeTab === 'employee'">
                        <button pButton type="button" label="Sao chép đường dẫn kích hoạt" class="p-button"
                            style="color: #fff !important"></button>
                        <button pButton type="button" label="Gửi email kích hoạt" class="p-button-danger"
                            style="color: #fff !important" (click)="toggleAccountStatus()"></button>
                    </ng-container>
                </div>
            </div>
        </p-dialog> -->

        <p-dialog
            header="Thông tin chi tiết"
            [(visible)]="isDialogVisible"
            [modal]="true"
            [style]="{ width: '60vw' }"
            [closable]="true"
            class="custom-dialog"
        >
            <div class="dialog-container">
                <!-- header -->
                <div class="header-section">
                    <img
                        [src]="baseImageUrl + selectedObject?.avatarUrl"
                        class="avatar-img"
                    />
                    <div class="user-details">
                        <h3>
                            {{ selectedObject?.firstName }}
                            {{ selectedObject?.lastName }}
                            <!-- svg icon -->
                        </h3>
                        <p>
                            {{ selectedObject?.firstName }}
                            {{ selectedObject?.lastName }} •
                            {{ selectedObject?.accountEmail }}
                        </p>
                        <div class="status">
                            <span class="status-badge working"
                                >Nhân viên:
                                {{
                                    selectedObject?.workingStatus == 0
                                        ? "Đang làm việc"
                                        : "Đang nghỉ việc"
                                }}</span
                            >
                            <span class="status-badge active"
                                >Tài khoản:
                                {{
                                    selectedObject?.accountStatus == 2
                                        ? "Đang hoạt động"
                                        : "Ngừng hoạt động"
                                }}</span
                            >
                            <!-- <span class="status-badge working">Nhân viên: {{selectedObject?.workingStatus == 0 ? 'Đang làm việc' : 'Đã nghỉ việc'}}</span>
                            <span class="status-badge active">Tài khoản:  {{selectedObject?.accountStatus == 2 ? 'Đang hoạt động' : 'Ngừng hoạt động'}}</span> -->
                        </div>
                    </div>
                </div>

                <!-- Tab section -->
                <div class="tab-section">
                    <ul class="tab-menu">
                        <li
                            [class.active]="activeTab === 'general'"
                            (click)="setActiveTab('general')"
                        >
                            Thông tin chung
                        </li>
                        <li
                            [class.active]="activeTab === 'employee'"
                            (click)="setActiveTab('employee')"
                        >
                            Thông tin nhân viên
                        </li>
                    </ul>
                </div>

                <div class="tab-content">
                    <div *ngIf="activeTab === 'general'" class="user-info">
                        <div class="info-item">
                            <strong>Họ và tên:</strong>
                            <span
                                >{{ selectedObject?.firstName }}
                                {{ selectedObject?.lastName }}</span
                            >
                        </div>
                        <div class="info-item">
                            <strong>Số điện thoại:</strong>
                            <span>{{ selectedObject?.phoneNumber }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Email liên hệ:</strong>
                            <a style="text-decoration: underline">{{
                                selectedObject?.accountEmail
                            }}</a>
                        </div>
                        <div class="info-item">
                            <strong>Email tài khoản:</strong>
                            <a
                                style="
                                    text-decoration: underline;
                                    color: rgb(0, 174, 255);
                                "
                                >{{ selectedObject?.accountEmail }}</a
                            >
                        </div>
                        <div class="info-item">
                            <strong>Ngày sinh:</strong>
                            <span>{{
                                selectedObject?.dateOfBirth
                                    | date : "dd-MM-yyyy"
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Địa chỉ:</strong>
                            <span>{{ selectedObject?.address }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Tỉnh/Thành phố:</strong>
                            <span></span>
                        </div>
                        <div class="info-item">
                            <strong>Quận/Huyện:</strong>
                            <span></span>
                        </div>
                        <div class="info-item">
                            <strong>Phường/Xã:</strong>
                            <span></span>
                        </div>
                        <div class="info-item">
                            <strong>Giới tính:</strong>
                            <span>{{
                                selectedObject?.sex == 0
                                    ? "Nữ"
                                    : selectedObject?.sex == 1
                                    ? "Nam"
                                    : "Khác"
                            }}</span>
                        </div>
                    </div>

                    <div *ngIf="activeTab === 'employee'" class="user-info">
                        <div class="info-item">
                            <strong>Mã nhân viên:</strong>
                            <span>{{ selectedObject.employeeCode }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Email công ty:</strong>
                            <span>{{ selectedObject.companyEmail }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Đơn vị công tác:</strong>
                            <span>{{
                                selectedObject.organizationLeaders[0]
                                    ?.organizationName
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Tên vị trí công việc:</strong>
                            <span>{{
                                selectedObject.staffPosition.positionName
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Chức danh:</strong>
                            <span>{{
                                selectedObject.staffTitle.staffTitleName
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Quản lý trực tiếp:</strong>
                            <span *ngIf="selectedObject.managerDirect != null"
                                >{{ selectedObject.managerDirect?.lastName }}
                                {{
                                    selectedObject.managerDirect?.firstName
                                }}</span
                            >
                            <span *ngIf="selectedObject.managerDirect == null"
                                >Không có</span
                            >
                        </div>
                        <div class="info-item">
                            <strong>Ngày thử việc:</strong>
                            <span>{{
                                selectedObject.probationDate
                                    | date : "dd-MM-yyyy"
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Ngày chính thức:</strong>
                            <span>{{
                                selectedObject.officialDate
                                    | date : "dd-MM-yyyy"
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Trạng thái lao động:</strong>
                            <span>{{
                                selectedObject.workingStatus == 0
                                    ? "Đang làm việc"
                                    : "Đã nghỉ việc"
                            }}</span>
                        </div>
                        <div class="info-item">
                            <strong>Ngày nghỉ việc:</strong>
                            <span>{{
                                selectedObject.leaveJobDate
                                    | date : "dd-MM-yyyy"
                            }}</span>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="dialog-footer" style="padding: 0; margin-top: 10px">
                    <!-- Nút duy nhất -->

                    <button
                        pButton
                        type="button"
                        label="Sao chép đường dẫn kích hoạt"
                        class="p-button"
                        style="color: #fff !important"
                    ></button>

                    <button
                        pButton
                        type="button"
                        [label]="
                            isEmailActivated
                                ? 'Ngừng kích hoạt'
                                : 'Kích hoạt tài khoản'
                        "
                        [class.p-button-success]="!isEmailActivated"
                        [class.p-button-danger]="isEmailActivated"
                        class="custom-button"
                        (click)="showConfirmDialog()"
                    ></button>

                    <!-- Hộp thoại xác nhận -->
                    <p-dialog
                        [(visible)]="isDialogVisiblekkk"
                        [modal]="true"
                        [closable]="false"
                        [style]="{ width: '430px' }"
                    >
                        <p-header style="font-weight: bold">
                            {{
                                isEmailActivated
                                    ? "Ngừng kích hoạt người dùng"
                                    : "Kích hoạt người dùng"
                            }}
                        </p-header>
                        <div>
                            <p>
                                Bạn có chắc chắn muốn
                                <span>{{
                                    isEmailActivated
                                        ? "ngừng kích hoạt"
                                        : "kích hoạt"
                                }}</span>
                                tài khoản
                                <strong>{{ employeeName }}</strong> không?
                            </p>
                        </div>
                        <p-footer>
                            <button
                                type="button"
                                pButton
                                label="Hủy"
                                icon="pi pi-times"
                                (click)="onReject()"
                            ></button>
                            <button
                                type="button"
                                pButton
                                [label]="
                                    isEmailActivated
                                        ? 'Xác nhận ngừng kích hoạt'
                                        : 'Xác nhận kích hoạt'
                                "
                                [class.p-button-success]="!isEmailActivated"
                                [class.p-button-danger]="isEmailActivated"
                                icon="pi pi-check"
                                (click)="onAccept()"
                            ></button>
                        </p-footer>
                    </p-dialog>
                </div>
            </div>
        </p-dialog>

        <!--  danh sách nhân viên -->
        <div class="card">
            <div class="flex justify-content-center" *ngIf="!istwo1">
                <span
                    class="block mt-2 md:mt-0 p-input-icon-left cursor-pointer"
                >
                    <i class="pi pi-email"></i>

                    <button
                        *ngIf="
                            this.permisionHelper.hasPermissions([
                                permissionConstant.ManageObjectSendMail
                            ])
                        "
                        (click)="handleShowSendMailActive()"
                        pButton
                        pRipple
                        label="Gửi lại Email kích hoạt"
                        style="height: 40px; width: 180px; border-radius: 10px"
                    ></button>
                    <button
                        *ngIf="
                            this.permisionHelper.hasPermissions([
                                permissionConstant.ManageObjectChangePosition
                            ])
                        "
                        (click)="showDialog2()"
                        pButton
                        pRipple
                        label="Thay đổi vị trí "
                        style="
                            margin-left: 5px;
                            height: 40px;
                            width: 180px;
                            border-radius: 10px;
                        "
                    ></button>
                    <button
                        *ngIf="
                            this.permisionHelper.hasPermissions([
                                permissionConstant.ManageObjectDelete
                            ])
                        "
                        (click)="showDialog3()"
                        pButton
                        pRipple
                        label="Xóa"
                        [style]="{
                            marginLeft: '5px',
                            height: '40px',
                            backgroundColor: 'red',
                            borderColor: 'red',
                            borderRadius: '5px !important'
                        }"
                    ></button>
                </span>
                <span
                    class="block mt-2 md:mt-0 p-input-icon-left ml-2 cursor-pointer"
                    *ngIf="!istwo1"
                >
                    <p-dialog
                        header="Cấp tổ chức"
                        [modal]="true"
                        [(visible)]="dialogVisible"
                        [style]="{ width: '450px' }"
                    >
                        <div class="">
                            <!--  Đơn vị -->

                            <div class="text-left">
                                <span class=""
                                    >Đơn vị công tác
                                    <span class="red-asterisk">*</span></span
                                >
                                <div
                                    class=""
                                    style="width: 400px"
                                    (focusout)="
                                        handleTreeSelectFocusOut($event)
                                    "
                                >
                                    <p-treeSelect
                                        class="w-full custom-tree-select w-full"
                                        containerStyleClass="w-full"
                                        [(ngModel)]="organizatioParentIdObject"
                                        [options]="nodes"
                                        placeholder="Chọn đơn vị"
                                        [showClear]="true"
                                        (onClear)="validateParentUnit()"
                                        (onChange)="onParentUnitChange($event)"
                                        [style]="{
                                            width: '400px',
                                            marginRight: '10px'
                                        }"
                                    />
                                    <div
                                        *ngIf="isParentUnitInvalid"
                                        style="color: red; font-size: 12px"
                                    >
                                        <span>Vui lòng chọn đơn vị</span>
                                    </div>
                                </div>
                            </div>

                            <!-- vị trí công việc -->
                            <div class="text-left mt-3">
                                <span style="margin-bottom: 3px"
                                    >Vị trí công việc</span
                                >
                                <p-dropdown
                                    [options]="listAllStaff"
                                    [(ngModel)]="selectedLocationUpdate"
                                    optionLabel="positionName"
                                    placeholder="Vị trí"
                                    [showClear]="true"
                                    [style]="{
                                        width: '400px',
                                        'margin-right': '10px'
                                    }"
                                    (onChange)="onPositionChange($event)"
                                />
                            </div>
                            <div class="text-left mt-3">
                                <span>Chức danh</span>
                                <input
                                    pInputText
                                    type="text"
                                    placeholder="Thêm cấp tổ chức"
                                    style="width: 400px"
                                    [hidden]="isCreateUnit"
                                    [(ngModel)]="staffTitleName"
                                    readonly
                                />
                            </div>
                            <div class="text-left mt-3 mb-5">
                                <span>Quản lý trực tiếp</span>

                                <p-multiSelect
                                    [options]="listEmployeeUpdate"
                                    [(ngModel)]="organizationLeadersUpdate"
                                    optionLabel="name"
                                    placeholder="Chọn quản lý trực tiếp"
                                    [showClear]="true"
                                    display="chip"
                                    [style]="{
                                        width: '400px',
                                        height: '45px',
                                        scrollY: 'auto'
                                    }"
                                    [selectionLimit]="1"
                                >
                                </p-multiSelect>

                                <div
                                    *ngIf="selectDepartmentHeads?.length"
                                    style="margin-top: 10px"
                                >
                                    <span
                                        *ngFor="
                                            let head of selectedDepartmentHeads;
                                            let i = index
                                        "
                                        class="selected-head"
                                        style="
                                            display: inline-block;
                                            margin-right: 10px;
                                            padding: 5px 10px;
                                            background-color: #f0f0f0;
                                            border-radius: 16px;
                                            position: relative;
                                        "
                                    >
                                        {{ head.name }}
                                        <button
                                            (click)="removeSelectedHead(i)"
                                            style="
                                                background: none;
                                                border: none;
                                                color: red;
                                                font-weight: bold;
                                                margin-left: 5px;
                                                cursor: pointer;
                                            "
                                        >
                                            x
                                        </button>
                                    </span>
                                </div>
                            </div>
                            <div
                                class=" "
                                style="display: flex; justify-content: end"
                            >
                                <span
                                    (click)="onDialogClose()"
                                    style="
                                        padding: 10px 10px;
                                        background-color: #fff;
                                        color: #000;
                                        border-radius: 6px;
                                        border: 1px solid #ccc;
                                        margin-right: 3px;
                                        cursor: pointer;
                                    "
                                    >Hủy</span
                                >
                                <p-button
                                    (click)="handleUpdateEmployee()"
                                    label="Lưu"
                                />
                            </div>
                        </div>
                    </p-dialog>
                </span>
                <span
                    *ngIf="!istwo1"
                    class="block mt-2 cursor-pointer"
                    style="
                        display: flex;
                        justify-content: center;
                        align-items: center;
                    "
                >
                    <p-dialog
                        header="Xóa nhân viên"
                        [modal]="true"
                        [(visible)]="isdelete"
                        [style]="{ width: '25rem' }"
                    >
                        <p>
                            Hệ thống sẽ xóa
                            {{ selectedEmployeeIds.length }} nhân viên :
                            <span *ngFor="let name of nameListEmployeeDelete"
                                >, {{ name }}</span
                            >
                        </p>
                        <div class="flex justify-content-end gap-2">
                            <p-button
                                (click)="handleDeleteEmployee()"
                                label="Xóa"
                                class="btn-delete"
                                [style]="{
                                    backgroundColor: 'red',
                                    borderColor: 'red',
                                    borderRadius: '5px !important'
                                }"
                            />

                            <p-button
                                label="Hủy"
                                severity="secondary"
                                (onClick)="hiddenDialogDelete()"
                                class="btn-cancel"
                                [style]="{
                                    backgroundColor: '#2a2986',
                                    borderColor: '#2a2986',
                                    borderRadius: '5px !important',
                                    color: 'white'
                                }"
                            />
                        </div>
                    </p-dialog>
                </span>
            </div>

            <div class="flex justify-content-between" *ngIf="istwo1">
                <!--  input search -->
                <div class="">
                    <span class="block mt-2 md:mt-0 p-input-icon-left">
                        <i class="pi pi-search"></i>
                        <input
                            pInputText
                            type="text"
                            placeholder="Tìm theo tên, điện thoại"
                            style="width: 300px"
                            [(ngModel)]="textSearch"
                        />
                    </span>
                </div>
                <div class="flex">
                    <!--  chọn đơn vị -->
                    <div class="ml-2 select-tree" style="width: 300px">
                        <p-treeSelect
                            class="md:w-20rem w-full"
                            containerStyleClass="w-full"
                            [(ngModel)]="organizatioParentSelect1"
                            [options]="nodes"
                            placeholder="Chọn đơn vị"
                            [showClear]="true"
                            (onChange)="onParentUnitChangeSearch($event)"
                        />
                    </div>

                    <!--  vị trí -->
                    <p-dropdown
                        [options]="listAllStaff"
                        [(ngModel)]="selectedLocation"
                        optionLabel="positionName"
                        placeholder="Vị trí"
                        [showClear]="true"
                        [style]="{ width: '150px', 'margin-right': '10px' }"
                    />
                    <!--  trạng thái tài khoản -->
                    <p-dropdown
                        [options]="optionAccountStatus"
                        [(ngModel)]="selectedAccountStatus"
                        optionLabel="name"
                        placeholder="Trạng thái"
                        [showClear]="true"
                        [style]="{ width: '250px' }"
                    ></p-dropdown>

                    <div
                        class="p-10 rounded border icon-settings cursor-pointer"
                        style="position: relative"
                    >
                        <i
                            (click)="openDialog('right')"
                            class="pi pi-spin pi-cog"
                            style="font-size: 1rem"
                        ></i>

                        <p-dialog
                            header="Tùy chỉnh cột"
                            [(visible)]="visible1"
                            class="custom-dialog"
                            [baseZIndex]="1000"
                            [dismissableMask]="true"
                            [position]="position"
                        >
                            <span class="block p-input-icon-left">
                                <i class="pi pi-search"></i>
                                <input
                                    pInputText
                                    type="text"
                                    placeholder="Tìm kiếm"
                                    [(ngModel)]="searchText"
                                    (input)="onSearch()"
                                    [style]="{ paddingLeft: '30px' }"
                                    [showClear]="true"
                                />
                            </span>

                            <div class="content-scroll">
                                <div
                                    class="flex align-items-center gap-3 mb-3 mt-3"
                                    *ngFor="let pr of filteredListheaderTable"
                                >
                                    <label for="username" class="font-semibold">
                                        <p-checkbox
                                            [(ngModel)]="pr.status"
                                            [binary]="true"
                                            inputId="binary"
                                        />
                                    </label>
                                    <span class="text-left">{{ pr.name }}</span>
                                </div>
                            </div>

                            <div class="p-dialog-footer">
                                <p-button
                                    (click)="resetDefaults()"
                                    label="Mặc định"
                                    [style]="{
                                        color: 'white',
                                        backgroundColor: '#ccc',
                                        borderColor: '#ccc',
                                        marginRight: '5px'
                                    }"
                                />
                                <p-button
                                    (click)="applyChanges()"
                                    label="Áp dụng"
                                />
                            </div>
                        </p-dialog>
                    </div>
                    <div class="flex justify-content-center">
                        <p-button class="ml-2" (click)="search()" label="Lọc" />
                    </div>
                </div>
            </div>

            <div class="table-section" style="margin-top: 20px">
                <p-table
                    responsiveLayout="scroll"
                    styleClass="p-datatable-striped"
                    [rowHover]="true"
                    [paginator]="false"
                    [value]="listAllEmployee"
                    [ngStyle]="{
                        width: 'auto',
                        'overflow-x': 'auto',
                        'table-layout': 'auto'
                    }"
                >
                    <ng-template pTemplate="header">
                        <tr>
                            <th class="sticky-col">
                                <p-checkbox
                                    [(ngModel)]="checked"
                                    [binary]="true"
                                    inputId="binary"
                                    (onChange)="onSelectAllChange()"
                                />
                            </th>
                            <th
                                [hidden]="!listable[0].status"
                                class="text-center sticky-col"
                                [style]="{ minWidth: '200px' }"
                            >
                                Mã nhân viên
                            </th>
                            <th
                                [hidden]="!listable[1].status"
                                class="text-center sticky-col"
                                [style]="{ minWidth: '200px' }"
                            >
                                Họ và tên
                            </th>
                            <th
                                [hidden]="!listable[2].status"
                                class="text-center"
                                [style]="{ minWidth: '300px' }"
                            >
                                Đơn vị công tác
                            </th>
                            <th
                                [hidden]="!listable[3].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Vị trí làm việc
                            </th>
                            <th
                                [hidden]="!listable[4].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Chức danh
                            </th>
                            <th
                                [hidden]="!listable[5].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Quản lý trực tiếp
                            </th>
                            <th
                                [hidden]="!listable[6].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Ngày thử việc
                            </th>
                            <th
                                [hidden]="!listable[7].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Ngày chính thức
                            </th>
                            <th
                                [hidden]="!listable[8].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Trạng thái lao động
                            </th>
                            <th
                                [hidden]="!listable[9].status"
                                class="text-center"
                                [style]="{ minWidth: '250px' }"
                            >
                                Trạng thái tài khoản
                            </th>
                            <th
                                [hidden]="!listable[10].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Điện thoại cá nhân
                            </th>
                            <th
                                [hidden]="!listable[11].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Điện thoại cơ quan
                            </th>
                            <th
                                [hidden]="!listable[12].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Email cá nhân
                            </th>
                            <th
                                [hidden]="!listable[13].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Email cơ quan
                            </th>
                            <th
                                [hidden]="!listable[14].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Ngày sinh
                            </th>
                            <th
                                [hidden]="!listable[15].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Giới tính
                            </th>
                            <th
                                [hidden]="!listable[16].status"
                                class="text-center"
                                [style]="{ minWidth: '200px' }"
                            >
                                Địa chỉ
                            </th>

                            <th
                                class="text-center"
                                [style]="{ minWidth: '100px' }"
                            >
                                Hành động
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-rowData let-i="rowIndex">
                        <tr style="cursor: pointer">
                            <td class="sticky-col">
                                <p-checkbox
                                    [(ngModel)]="rowData.checked"
                                    [binary]="true"
                                    inputId="binary{{ i }}"
                                    (onChange)="onCheckboxChange()"
                                />
                            </td>
                            <td
                                class="min-w-200 sticky-col"
                                [hidden]="!listable[0].status"
                            >
                                {{ rowData.employeeCode }}
                            </td>
                            <td
                                class="min-w-200 sticky-col"
                                [hidden]="!listable[1].status"
                            >
                                <div
                                    class="d-flex justify-content-left align-items-center"
                                >
                                    <img
                                        [src]="
                                            baseImageUrl + rowData?.avatarUrl
                                        "
                                        style="border-radius: 50%"
                                        width="40px"
                                        height="40px"
                                        class="me-2"
                                    />
                                    <span
                                        class="ml-2"
                                        (click)="onObjectClick(rowData)"
                                    >
                                        {{ rowData?.lastName }}
                                        {{ rowData?.firstName }}
                                    </span>
                                </div>
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[2].status"
                            >
                                {{ rowData?.organization?.organizationName }}
                            </td>

                            <td
                                class="text-center"
                                [hidden]="!listable[3].status"
                            >
                                {{ rowData?.staffPosition?.positionName }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[4].status"
                            >
                                {{ rowData?.staffTitle?.staffTitleName }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[5].status"
                            >
                                {{ rowData?.managerDirect?.lastName }}
                                {{ rowData?.managerDirect?.firstName }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[6].status"
                            >
                                {{
                                    rowData?.probationDate | date : "dd/MM/yyyy"
                                }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[7].status"
                            >
                                {{
                                    rowData?.officialDate | date : "dd/MM/yyyy"
                                }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[8].status"
                                style="cursor: pointer"
                            >
                                <span
                                    class="work-status-span"
                                    [ngStyle]="{
                                        color: getWorkStatus(
                                            rowData?.workingStatus
                                        ).color,
                                        'background-color': getWorkStatus(
                                            rowData?.workingStatus
                                        ).bgcolor
                                    }"
                                >
                                    {{
                                        getWorkStatus(rowData?.workingStatus)
                                            .text
                                    }}
                                </span>
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[9].status"
                            >
                                <span
                                    class="status-span"
                                    [ngStyle]="{
                                        color: getAccountStatus(
                                            rowData?.accountStatus
                                        ).color,
                                        'background-color': getAccountStatus(
                                            rowData?.accountStatus
                                        ).bgColor
                                    }"
                                >
                                    {{
                                        getAccountStatus(rowData?.accountStatus)
                                            .text
                                    }}
                                </span>
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[10].status"
                            >
                                {{ rowData?.phoneNumber }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[11].status"
                            >
                                {{ rowData?.workPhoneNumber }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[12].status"
                            >
                                {{ rowData?.accountEmail }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[13].status"
                            >
                                {{ rowData?.companyEmail }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[14].status"
                            >
                                {{ rowData?.dateOfBirth | date : "dd/MM/yyyy" }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[15].status"
                            >
                                {{ getSexStatus(rowData?.sex).text }}
                            </td>
                            <td
                                class="text-center"
                                [hidden]="!listable[16].status"
                            >
                                {{ rowData?.address }} {{ rowData?.street }}
                                {{ rowData?.ward }} {{ rowData?.district }}
                                {{ rowData?.city }}
                            </td>
                            <td
                                class="text-center"
                                class="cursor-pointer position-relative"
                            >
                                <div class="" style="display: flex">
                                    <div
                                        *ngIf="
                                            this.permisionHelper.hasPermissions(
                                                [

                                                        permissionConstant.ManageObjectSendMail

                                                ]
                                            )
                                        "
                                        class="font-size-16 ml-2"
                                        style="padding: 3px; border-radius: 50%"
                                        (click)="handleShowResendEmail(rowData)"
                                    >
                                        <i class="pi pi-envelope"></i>
                                    </div>
                                    <div
                                        *ngIf="
                                            this.permisionHelper.hasPermissions(
                                                [

                                                        permissionConstant.ManageObjectEdit

                                                ]
                                            )
                                        "
                                        class="font-size-16 ml-2"
                                        style="padding: 3px; border-radius: 50%"
                                        [routerLink]="[
                                            '/object/edit',
                                            rowData.id
                                        ]"
                                    >
                                        <i class="pi pi-file-edit"></i>
                                    </div>
                                    <div
                                        *ngIf="
                                            this.permisionHelper.hasPermissions(
                                                [

                                                        permissionConstant.ManageObjectSendMail

                                                ]
                                            )
                                        "
                                        class="font-size-16"
                                        style="padding: 3px; border-radius: 50%"
                                        (click)="onObjectClick(rowData)"
                                    >
                                        <i class="pi pi-eye"></i>
                                    </div>
                                    <!-- <div
                                        *ngIf="
                                            this.permisionHelper.hasPermissions(
                                                [

                                                        permissionConstant.ManageObjectDelete

                                                ]
                                            )
                                        "
                                        class="font-size-16"
                                        style="padding: 3px; border-radius: 50%"
                                    >
                                        <i
                                            (click)="
                                                openDeleteDialog(rowData.id)
                                            "
                                            class="pi pi-trash"
                                        ></i>
                                    </div> -->
                                </div>
                            </td>
                        </tr>
                    </ng-template>

                    <ng-template pTemplate="empty">
                        <tbody>
                            <tr>
                                <td colspan="8" class="text-center">
                                    Không có dữ liệu
                                </td>
                            </tr>
                        </tbody>
                    </ng-template>
                </p-table>

                <div>
                    <div
                        class="flex justify-content-between"
                        *ngIf="totalItems > 0"
                    >
                        <div class="paging-info">
                            <p [innerHTML]="currentPageReport"></p>
                        </div>
                        <p-paginator
                            [rows]="pageSize"
                            [totalRecords]="totalItems"
                            [rowsPerPageOptions]="[10, 20, 30]"
                            (onPageChange)="onPageChange($event)"
                            (onRowsPerPageChange)="onPageSizeChange($event)"
                            [first]="(pageIndex - 1) * pageSize"
                            [pageLinkSize]="3"
                        ></p-paginator>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<p-dialog
    header="Thông báo"
    [modal]="true"
    [(visible)]="isResendEmail"
    [style]="{ width: '25rem' }"
>
    <p>
        Bạn có muốn gửi email kích hoạt cho tài khoản:
        <span>{{ selectedEmployee?.accountEmail }}</span
        >?
    </p>
    <div class="flex justify-content-end gap-2">
        <p-button
            label="Xác nhận"
            (onClick)="handleResendEmail(true)"
            severity="secondary"
        />
        <p-button label="Hủy" (onClick)="handleResendEmail(false)" />
    </div>
</p-dialog>

<p-dialog
    header="Xóa"
    [modal]="true"
    [(visible)]="showSendMailActive"
    [style]="{ width: '25rem' }"
>
    <p>
        Bạn có muốn gửi lại email kích hoạt cho các email :
        <span *ngFor="let selectedEmployee of selectedEmployees">
            {{ selectedEmployee.accountEmail }},
        </span>
        không?
    </p>
    <div class="flex justify-content-end gap-2">
        <p-button (onClick)="handleReSendMailMultiple()" label="Xác nhận" />
        <p-button
            label="Hủy"
            severity="secondary"
            (onClick)="showSendMailActive = false"
        />
        <!-- <button class="btn btn ">Không</button>
            <button class="btn btn-danger ">Xóa</button> -->
    </div>
</p-dialog>
<p-dialog
    header="Xóa nhân viên"
    [modal]="true"
    [(visible)]="isdeleteOne"
    [style]="{ width: '25rem' }"
>
    <p>Hệ thống sẽ xóa nhân viên đã chọn: {{ nameListEmployeeDeleteOne }}</p>
    <div class="flex justify-content-end gap-2">
        <p-button
            (click)="handledeleteOneEmp()"
            label="Xóa"
            class="btn-delete"
            [style]="{
                backgroundColor: 'red',
                borderColor: 'red',
                borderRadius: '5px !important'
            }"
        />
        <p-button
            label="Hủy"
            severity="secondary"
            (onClick)="closeDeleteOneEmp()"
            class="btn-cancel"
            [style]="{
                backgroundColor: '#2a2986',
                borderColor: '#2a2986',
                borderRadius: '5px !important',
                color: 'white'
            }"
        />
    </div>
</p-dialog>
